
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dashboard - Admin (Mejorado)</title>
  <link rel="stylesheet" href="admin.css">
</head>
<body>
  <div class="dash-wrap">
    <div class="dash-top">
      <h1>Panel de Administración</h1>
      <div>
        <button id="btn-home" class="btn outline">Inicio</button>
        <button id="btn-logout" class="btn">Cerrar sesión</button>
      </div>
    </div>

    <!-- KPIs de Usuarios y Analytics -->
    <div class="dash-card">
      <div class="row">
        <div class="col">
          <h2 style="margin:0 0 6px">Usuarios</h2>
          <p class="mut" style="margin-top:-4px">(Demo con localStorage)</p>
          <div class="dash-grid">
            <div class="dash-card kpi"><strong>Total usuarios</strong><div id="kpi-users" class="num">0</div></div>
            <div class="dash-card kpi"><strong>Admins</strong><div id="kpi-admins" class="num">0</div></div>
            <div class="dash-card kpi"><strong>Usuarios</strong><div id="kpi-commons" class="num">0</div></div>
          </div>
          <div style="margin-top:14px; overflow:auto">
            <table id="tbl-users">
              <thead><tr><th>Nombre</th><th>Email</th><th>Rol</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
        <div class="col">
          <h2 style="margin:0 0 6px">Analytics</h2>
          <p class="mut" style="margin-top:-4px">Visitas & clics (por sesión y acumulado)</p>
          <div class="dash-grid">
            <div class="dash-card kpi"><strong>Visitas de página (acumulado)</strong><div id="kpi-views" class="num">0</div></div>
            <div class="dash-card kpi"><strong>Sesiones únicas</strong><div id="kpi-sessions" class="num">0</div></div>
            <div class="dash-card kpi"><strong>Clics totales</strong><div id="kpi-clicks" class="num">0</div></div>
          </div>
          <div style="margin-top:12px">
            <span class="chip">Esta sesión: <strong id="chip-session-clicks">0</strong> clics</span>
          </div>
          <div class="divider"></div>
          <div>
            <strong>Productos más vendidos</strong>
            <ol id="top-products" style="margin:8px 0 0 16px"></ol>
          </div>
        </div>
      </div>
    </div>

    <!-- Gestión de Productos -->
    <div class="dash-card" style="margin-top:16px">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px">
        <h2 style="margin:0">Productos</h2>
        <div class="tag">CRUD local: agregar, editar precio, stock, borrar, registrar venta</div>
      </div>

      <form id="form-product" class="form" style="margin-top:12px">
        <div class="fld" style="grid-column:span 2">
          <label for="pname">Nombre</label>
          <input id="pname" required placeholder="Ej: Pan de masa madre" />
        </div>
        <div class="fld">
          <label for="pprice">Precio</label>
          <input id="pprice" type="number" step="0.01" min="0" required placeholder="0" />
        </div>
        <div class="fld">
          <label for="pstock">Stock</label>
          <input id="pstock" type="number" min="0" required placeholder="0" />
        </div>
        <div class="fld">
          <label for="pcat">Categoría</label>
          <input id="pcat" placeholder="Ej: Bakery" />
        </div>
        <div class="fld" style="grid-column:span 1">
          <button class="btn" type="submit">Agregar producto</button>
        </div>
      </form>

      <div style="margin-top:12px; overflow:auto">
        <table id="tbl-products">
          <thead>
            <tr>
              <th>Producto</th>
              <th>Precio</th>
              <th>Stock</th>
              <th>Ventas</th>
              <th>Categoría</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Modal Editar Precio/Stock -->
  <div class="modal" id="modal-edit">
    <div class="box">
      <h3 style="margin:0 0 8px">Editar producto</h3>
      <form id="form-edit" class="form" style="grid-template-columns:repeat(4,1fr)">
        <input type="hidden" id="edit-id" />
        <div class="fld"><label>Nombre</label><input id="edit-name" required /></div>
        <div class="fld"><label>Precio</label><input id="edit-price" type="number" step="0.01" min="0" required /></div>
        <div class="fld"><label>Stock</label><input id="edit-stock" type="number" min="0" required /></div>
        <div class="fld"><label>Categoría</label><input id="edit-cat" /></div>
        <div class="fld" style="grid-column:span 4;display:flex;gap:8px;justify-content:flex-end">
          <button type="button" class="btn outline" id="btn-cancel-edit">Cancelar</button>
          <button class="btn" type="submit">Guardar cambios</button>
        </div>
      </form>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
